## 13.0 INTERRUPT-ON-CHANGE

PORTBピンは、変更時割り込み（IOC）ピンとして動作するように設定できます。
 割り込みは、立ち上がりエッジまたは立ち下がりエッジを持つ信号を検出することで生成できます。
 個々のPORTBピンは、割り込みを生成するように構成できます。
 変更時割り込みモジュールには、次の機能があります。
•変更時割り込みの有効化（マスタースイッチ）
•個々のピン構成
•立ち上がりエッジと立ち下がりエッジの検出
•個々のピン割り込みフラグ
図13-1は、IOCモジュールのブロック図です。

## 13.1 Enabling the Module

個々のポートピンが割り込みを生成できるようにするには、INTCONレジスタのIOCIEビットをセットする必要があります。
 IOCIEビットが無効の場合でも、ピンのエッジ検出は発生しますが、割り込みは生成されません。

## 13.2 個別のピン構成

 各ポートピンには、立ち上がりエッジ検出器と立ち下がりエッジ検出器が存在します。
 ピンが立ち上がりエッジを検出できるようにするには、IOCBPレジスタの関連するIOCBPxビットをセットします。
 ピンが立ち下がりエッジを検出できるようにするには、IOCBNレジスタの関連するIOCBNxビットをセットします。
 IOCBPおよびIOCBNレジスタのIOCBPxビットとIOCBNxビットの両方をそれぞれ設定することにより、ピンを立ち上がりエッジと立ち下がりエッジを同時に検出するように構成できます。

## 13.3 Interrupt Flags

IOCBFレジスタにあるIOCBFxビットは、ポートの変更時割り込みピンに対応するステータスフラグです。
 適切に有効化されたピンで予期されるエッジが検出されると、そのピンのステータスフラグが設定され、IOCIEビットが設定されている場合は割り込みが生成されます。
 INTCONレジスタのIOCIFビットは、すべてのIOCBFxビットのステータスを反映します。

## 13.4 Clearing Interrupt Flags

個々のステータスフラグ（IOCBFxビット）は、ゼロにリセットすることでクリアできます。
。このクリア操作中に別のエッジが検出されると、実際に書き込まれている値に関係なく、関連するステータスフラグがシーケンスの最後に設定されます。
 フラグのクリア中に検出されたエッジが失われないようにするために、既知の変更されたビットをマスクするAND演算のみを実行する必要があります。
 次のシーケンスは、実行する必要があるものの例です。
