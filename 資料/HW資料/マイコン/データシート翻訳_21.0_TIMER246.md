## 21.0 TIMER2/4/6 MODULES

最大2つの同じTimer2タイプのモジュールを使用できます。既存の命名規則を維持するために、タイマーはTimer2、Timer4、Timer6（およびTimer2 / 4 / 6 ）と呼ばれます。

注：このセクションで使用される「x」変数は、Timer2、Timer4、またはTimer6を指定するために使用されます。たとえば、TxCONはT2CON、T4CON、またはT6CONを参照します。 PRxは、PR2、PR4、またはPR6を参照します。

Timer2 / 4/6モジュールには、次の機能が組み込まれています。
•8ビットのタイマーおよび周期レジスタ（それぞれTMRxおよびPRx）
•読み取りおよび書き込み可能（両方のレジスター）
•ソフトウェアプログラマブルプリスケーラー（1：1、1：4、1：16、および1:64）
•ソフトウェアプログラマブルポストスケーラー（1：1〜1:16）
•TMRxの割り込みはそれぞれPRxと一致
•MSSPxモジュールのシフトクロックとしてのオプションの使用（Timer2のみ）

Timer2 / 4/6のブロック図については、図21-1を参照してください。


## 21.1 Timer2/4/6 Operation

Timer2 / 4/6モジュールへのクロック入力は、システム命令クロック（FOSC / 4）です。
 TMRxは、各クロックエッジで00hからインクリメントします。
 クロック入力の4ビットカウンター/プリスケーラーにより、直接入力、4分周、16分周のプリスケールオプションを使用できます。
 これらのオプションは、TxCONレジスタのプリスケーラ制御ビットTxCKPS <1：0>によって選択されます。
 TMRxの値は、各クロックサイクルで期間レジスタPRxの値と比較されます。
 2つの値が一致すると、コンパレータはタイマー出力として一致信号を生成します。
 この信号は、次のサイクルでTMRxの値を00hにリセットし、出力カウンター/ポストスケーラーを駆動します（セクション21.2「Timer2 / 4/6割り込み」を参照）。
 TMRxレジスタとPRxレジスタは、どちらも直接読み取りと書き込みが可能です。
 TMRxレジスタはデバイスリセットでクリアされますが、PRxレジスタはFFhに初期化されます。
 プリスケーラとポストスケーラの両方のカウンタは、次のイベントでクリアされます。
•TMRxレジスタへの書き込み
•TxCONレジスタへの書き込み
•パワーオンリセット（POR）
•ブラウンアウトリセット（BOR）
•MCLRリセット
•ウォッチドッグタイマー（WDT）リセット
•スタックオーバーフローのリセット
•スタックアンダーフローのリセット
•RESET命令

注：TxCONが書き込まれるとき、TMRxはクリアされません。


## 21.2 Timer2/4/6 Interrupt

Timer2 / 4/6は、オプションのデバイス割り込みを生成することもできます。
 Timer2 / 4/6出力信号（TMRxからPRxへの一致）は、4ビットのカウンタ/ポストスケーラに入力を提供します。
 このカウンタは、TMRx一致割り込みフラグを生成します。これは、PIRxレジスタのTMRxIFにラッチされます。
 割り込みを有効にするには、PIExレジスタのTMRx一致割り込み有効化ビットTMRxIEを設定します。
 TxCONレジスタのポストスケーラ制御ビットTxOUTPS <3：0>で、16のポストスケールオプション（1：1から1:16まで）の範囲を選択できます。

 ## 21.3 Timer2/4/6 Output

TMRxのスケーリングされていない出力は、主にCCPモジュールで使用でき、PWMモードでの動作のタイムベースとして使用されます。
 Timer2は、SPIモードで動作するMSSPxモジュールのシフトクロックソースとしてオプションで使用できます。
 詳細については、セクション24.0「マスターシンクロノ」を参照してください。
